<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>



  <link href='//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="Chandler's Blog" />



  <meta name="keywords" content="Hexo,next" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="Chandler&apos;s Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Amateur Programming">
<meta property="og:url" content="http://github.com/ttma1046/index.html">
<meta property="og:site_name" content="Amateur Programming">
<meta property="og:description" content="Chandler&apos;s Blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Amateur Programming">
<meta name="twitter:description" content="Chandler&apos;s Blog">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post'
  };
</script>

  <title> Amateur Programming </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">Amateur Programming</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            Tags
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/02/14/howgarbagecollectionworks/" itemprop="url">
                How Garbage Collection works in .Net
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-02-14T23:19:11+00:00" content="2016-02-14">
            2016-02-14
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="Understanding_the_Basics_of_Working_in_a_Garbage-Collected_Platform">Understanding the Basics of Working in a Garbage-Collected Platform</h2><p>Every program uses resources of one sort or another, be they files, memory buffers, screen<br>space, network connections, database resources, and so on. </p>
<p>In fact, in an object-oriented environment, every <strong>type</strong> identifies some resource available for a program’s use. </p>
<p>To use any of these resources requires memory to be allocated to represent the type. The following steps are required to access a resource:</p>
<ol>
<li><p>Allocate memory for the type that represents the resource by calling the intermediate<br>language’s <strong>newobj</strong> instruction, which is emitted when you use <strong>the new operator in C#</strong>.</p>
</li>
<li><p><strong>Initialize the memory</strong> to <strong>set the initial state</strong> of the resource and to <strong>make the resource usable</strong>. The type’s <strong>instance constructor</strong> is responsible for setting this initial state.</p>
</li>
<li><p><strong>Use the resource</strong> by <strong>accessing the type’s members</strong> (repeating as necessary).</p>
</li>
<li><p><strong>Tear down</strong>(vt. 向 猛扑，冲下; 拆毁，拆卸) the state of a resource to clean up.<br>I’ll address this topic in the section “The Dispose Pattern: Forcing an Object to Clean Up” later in this chapter.</p>
</li>
<li><p>Free the memory. The <strong>garbage collector</strong> is solely <strong>responsible</strong> for this step.</p>
</li>
</ol>
<p>This seemingly simple paradigm has been one of the major sources of programming errors.</p>
<p><em>How many times have programmers forgotten to free memory when it is no longer needed? 
</em>How many times have programmers attempted to use memory after it had already been freed?</p>
<p>With unmanaged programming, these two application bugs are worse than most others<br>because you usually can’t predict the consequences or the timing of them. </p>
<p>For other bugs, when you see your application misbehaving, you just fix the problem. </p>
<p>But these two bugs cause resource leaks (memory consumption) and object corruption (destabilization), making the application perform unpredictably. </p>
<p>In fact, there are many tools (such as the Microsoft Windows Task Manager, the System Monitor ActiveX Control, NuMega BoundsChecker from Compuware, and Rational’s Purify) that are specifically designed to help developers locate these types of bugs.</p>
<p>Proper resource management is very difficult and quite tedious(adj. 单调沉闷的; 冗长乏味的; 令人生厌的). </p>
<p>It distracts developers from concentrating on the real problems that they’re trying to solve. </p>
<p>It would be wonderful if some mechanism existed that simplified the mind-numbing(adj.<br>（糟糕、无聊或程度强烈到）令人头脑麻木的) memory-management task for developers.</p>
<p>Fortunately, there is: <strong>Garbage Collection</strong>.</p>
<p>Garbage collection completely absolves the developer from having to track memory usage and<br>know when to free memory. </p>
<p>However, the garbage collector doesn’t know anything about the resource represented by the type in memory, which means that a garbage collector can’t know how to perform Step 4 in the preceding list: </p>
<blockquote>
<p>tear down the state of a resource to clean up. </p>
</blockquote>
<p>To get a resource to clean up properly, the developer must write code that knows how to properly clean up a resource. </p>
<p>The developer writes this code in the <code>Finalize</code>, <code>Dispose</code>, and <code>Close</code> methods, as described later in this chapter. </p>
<p>However, as you’ll see, the garbage collector can offer some assistance here too, allowing developers to skip Step 4 in many circumstances.</p>
<p>Also, most types, including String, Attribute, Delegate, and Exception, represent resources<br>that don’t require any special cleanup. </p>
<p>For example, a String resource can be completely cleaned up simply by destroying the character array maintained in the object’s memory.</p>
<p>On the other hand, a type that represents (or wraps) an unmanaged or native resource, such<br>as a file, a database connection, a socket, a mutex, a bitmap, an icon, and so on, always<br>requires the execution of some cleanup code when the object is about to have its memory<br>reclaimed. </p>
<p>In this chapter, I’ll explain how to properly define types that require explicit clean<br>up, and I’ll show you how to properly use types that offer this explicit clean-up. </p>
<p>For now, let’s examine how memory is allocated and how resources are initialized.</p>
<h2 id="Allocating_Resources_from_the_Managed_Heap">Allocating Resources from the Managed Heap</h2><p>The CLR requires that all resources to be allocated from a heap called <strong>the managed heap</strong>. </p>
<p>This heap is similar to a C-runtime heap, except that you <strong>never delete objects</strong> from the managed heap.</p>
<p>Objects are <strong>automatically deleted</strong> when the application no longer needs them. </p>
<p>This, of course, raises the question, “How does the managed heap know when the application is no longer using an object?” I’ll address this question shortly.</p>
<p>Several garbage-collection algorithms are in use today. </p>
<p>Each algorithm is fine-tuned for a particular environment to provide the best performance. </p>
<p>In this chapter, I’ll concentrate on the garbage-collection algorithm used by the Microsoft .NET Framework’s CLR. </p>
<p>Let’s start off with the basic concepts.</p>
<p>When a process is initialized, the CLR reserves a contiguous region of address space that initially contains no backing storage. </p>
<p>This address space region is the managed heap. </p>
<p>The heap also maintains a pointer, which I’ll call NextObjPtr. This pointer indicates where the next object is to be allocated within the heap. </p>
<p>Initially, NextObjPtr is set to the base address of the reserved address space region.</p>
<p>The <strong>newobj</strong> intermediate language (IL) instruction creates an object. </p>
<p>Many languages (including C#, C++/CLI, and Microsoft Visual Basic) offer a new operator that causes the compiler to <strong>emit a newobj instruction</strong> into the method’s IL code. </p>
<p>The newobj instruction causes the CLR to perform the following steps:</p>
<ol>
<li><p>Calculate the number of bytes required for the type’s (and all of its base type’s) fields.</p>
</li>
<li><p>Add the bytes required for an object’s overhead. Each object has two overhead fields:<br>a type object pointer and a sync block index. For a 32-bit application, each of these<br>fields requires 32 bits, adding 8 bytes to each object. For a 64-bit application, each field<br>is 64 bits, adding 16 bytes to each object.</p>
</li>
<li><p>The CLR then checks that the bytes required to allocate the object are available in the<br>reserved region (committing storage if necessary). If there is enough free space in the<br>managed heap, the object will fit, starting at the address pointed to by NextObjPtr,<br>and these bytes are zeroed out. The type’s constructor is called (passing NextObjPtr<br>for the this parameter), and the newobj IL instruction (or C#’s new operator) returns<br>the address of the object. Just before the address is returned, NextObjPtr is advanced<br>past the object and now points to the address where the next object will be placed in<br>the heap.</p>
</li>
</ol>
<p>Figure 20-1 shows a managed heap consisting of three objects: A, B, and C. If a new object<br>were to be allocated, it would be placed where <strong>NextObjPtr</strong> points to (immediately after<br>object C).</p>
<p>By contrast, let’s look at how the C-runtime heap allocates memory. </p>
<p>In a C-runtime heap, allocating memory for an object requires walking through a linked list of data structures. </p>
<p>Once a large enough block is found, that block is split, and pointers in the linked-list nodes<br>are modified to keep everything intact. </p>
<p>For the managed heap, allocating an object simply means adding a value to a pointer—this is blazingly fast by comparison. </p>
<p>In fact, allocating an object from the managed heap is nearly as fast as allocating memory from a thread’s stack! </p>
<p>In addition, most heaps (such as the C-runtime heap) allocate objects wherever they find free space.</p>
<p>Therefore, if I create several objects consecutively, it’s quite possible for these objects to be separated by megabytes of address space.</p>
<p>In the managed heap, however, allocating several objects consecutively ensures that the objects are contiguous in memory.</p>
<p>In many applications, objects allocated around the same time tend to have strong relationships to each other and are frequently accessed around the same time. </p>
<p>For example, it’s very common to allocate a FileStream object immediately before a BinaryWriter object is created. Then the application would use the BinaryWriter object, which internally uses the<br>FileStream object. </p>
<p>In a garbage-collected environment, new objects are allocated contiguously in memory, providing performance gains resulting from locality of reference. </p>
<p>Specifically, this means that your process’ working set will be smaller than a similar application running in a non-managed environment. </p>
<p>It’s also likely that the objects that your code is using can all reside in the CPU’s cache. </p>
<p>Your application will access these objects with phenomenal speed because the CPU will be able to perform most of its manipulations without having cache misses that would force slower access to RAM.</p>
<p>So far, it sounds as if the managed heap is far superior to the C-runtime heap because of its simplicity of implementation and speed. </p>
<p>But there’s one little detail you should know about before getting too excited. </p>
<p>The managed heap gains these advantages because it makes one really big assumption: that address space and storage are infinite. </p>
<p>Obviously, this assumption is ridiculous, and the managed heap must employ a mechanism to allow it to make this assumption. </p>
<p>This mechanism is the garbage collector. </p>
<p>Here’s how it works:</p>
<p>When an application calls the new operator to create an object, there might not be enough address space left in the region to allocate to the object. </p>
<p>The heap detects this lack of space by adding the bytes that the object requires to the address in NextObjPtr. </p>
<p>If the resulting value is beyond the end of the address space region, the heap is full, and a garbage collection must be performed.</p>
<p>Important:<br>What I’ve just said is an oversimplification. </p>
<p>In reality, a garbage collection occurs when generation 0 is full. </p>
<p>Some garbage collectors use generations, a mechanism whose sole purpose is to improve performance. </p>
<p>The idea is that newly created objects are part of a young generation and objects created early in the application’s lifecycle are in an old generation.</p>
<p>Objects in Generation 0 are objects that have recently been allocated and have never been examined by the garbage collector algorithm.</p>
<p>Objects that survive a collection are promoted to another generation (such as Generation 1). </p>
<p>Separating objects into generations allows the garbage collector to collect specific generations instead of collecting all of the objects in the managed heap. </p>
<p>I’ll explain generations in more detail later in this chapter. </p>
<p>Until then, it’s easiest for you to think that a garbage collection occurs when the heap is full. </p>
<h2 id="The_Garbage_Collection_Algorithm">The Garbage Collection Algorithm</h2><p>The garbage collector checks to see if any objects in the heap are no longer being used by the application. </p>
<p>If such objects exist, the memory used by these objects can be reclaimed. </p>
<p>(If no more memory is available in the heap after a garbage collection,new throws an OutOfMemory-Exception.)</p>
<p>How does the garbage collector know whether the application is using an object?</p>
<p>As you might imagine, this isn’t a simple question to answer.</p>
<p>Every application has a set of roots. </p>
<p>A single root is a storage location containing a memory pointer to a reference type object. </p>
<p>This pointer either refers to an object in the managed heap or is set to null. </p>
<p>For example, a static field (defined within a type) is considered a root. </p>
<p>In addition, any method parameter or local variable is also considered a root. </p>
<p>Only variables that are of a reference type are considered roots; value type variables are never considered roots.</p>
<p>Now, let’s look at a concrete example starting with the following class definition:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">SomeType</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> TextWriter m_textWriter;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SomeType</span>(<span class="params">TextWriter tw</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        m_textWriter = tw;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">WriteBytes</span>(<span class="params">Byte[] bytes</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Int32 x = <span class="number">0</span>; x &lt; bytes.Length; x++)</span><br><span class="line">        &#123;</span><br><span class="line">            m_textWriter.Write(bytes[x]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The first time the WriteBytes method is called, the JIT compiler converts the method’s IL code into native CPU instructions. Let’s say the CLR is running on an x86 CPU, and the JIT<br>compiler compiles the WriteBytes method into the CPU instructions shown in Figure 20-2.</p>
<p>(I added comments on the right to help you understand how the native code maps back to the original source code.)</p>
<p>00000000 push edi                       // Prolog<br>00000001 push esi<br>00000002 push ebx<br>00000003 mov ebx,ecx                    // ebx = this (argument)<br>00000005 mov esi,edx                    // esi = bytes array (argument)<br>00000007 xor edi,edi                    // edi = x (a value type)<br>00000009 cmp dword ptr [esi+4],0        // compare bytes.Length with 0<br>0000000d jle 0000002A                   // if bytes.Length &lt;=0, go to 2a<br>0000000f mov ecx,dword ptr [ebx+4]      // ecx = m_textWriter (field)<br>00000012 cmp edi,dword ptr [esi+4]      // compare x with bytes.Length<br>00000015 jae 0000002E                   // if x &gt;= bytes.Length, go to 2e<br>00000017 movzx edx,byte ptr [esi+edi+8] // edx = bytes[x]<br>0000001c mov eax,dword ptr [ecx]        // eax = m_textWriter’s type object<br>0000001e call dword ptr [eax+000000BCh] // Call m_textWriter’s write method<br>00000024 inc edi                        // x++<br>00000025 cmp dword ptr [esi+4],edi      // compare bytes.Length with x<br>00000028 jg 0000000F                    // if bytes.Length &gt; x, go to f<br>0000002a pop ebx                        // Epilog<br>0000002b pop esi<br>0000002c pop edi<br>0000002d ret                            // return to caller<br>0000002e call 76B6E337                  // Throw IndexOutOfRangeException<br>00000033 int 3                          // Break in debugger<br>Figure 20-2 Native code produced by the JIT compiler with ranges of roots shown</p>
<p>As the JIT compiler produces the native code, it also creates an internal table. </p>
<p>Logically, each entry in the table indicates a range of byte offsets in the method’s native CPU instructions,<br>and for each range, a set of memory addresses and CPU registers that contain roots.</p>
<p>For the WriteBytes method, this table reflects that the EBX register starts being a root at offset<br>0x00000003, the ESI register starts being a root at offset 0x00000005, and the ECX register<br>starts being a root at offset 0x0000000f. </p>
<p>All three of these registers stop being roots at the end of the loop (offset 0x00000028). </p>
<p>Also note that the EAX register is a root from 0x0000001c to 0x0000001e. </p>
<p>The EDI register is used to hold the Int32 value represented by the variable x in the original source code. </p>
<p>Since Int32 is a value type, the JIT compiler doesn’t consider the EDI register to be a root.</p>
<p>The WriteBytes method is a fairly simple method, and all of the variables that it uses can be enregistered. </p>
<p>A more complex method could use all of the available CPU registers, and some roots would be in memory locations relative to the method’s stack frame. </p>
<p>Also note that on an x86 architecture, the CLR passes the first two arguments to a method via the ECX and EDX registers. </p>
<p>For instance methods, the first argument is the this pointer, which is always passed in the ECX register. </p>
<p>For the WriteBytes method, this is how I know that the this pointer is passed in the ECX register and stored in the EBX register right after the method prolog. </p>
<p>This is also how I know that the bytes argument is passed in the EDX register and stored in the ESI register after the prolog.</p>
<p>If a garbage collection were to start while code was executing at offset 0x00000017 in the WriteBytes method, the garbage collector would know that the objects referred to by the EBX<br>(this argument), ESI (bytes argument), and ECX (the m_textWriter field) registers were all roots and refer to objects in the heap that shouldn’t be considered garbage.</p>
<p>In addition, the garbage collector can walk up the thread’s call stack and determine the roots for all of the calling methods by examining each method’s internal table. </p>
<p>The garbage collector iterates through all the type objects to obtain the set of roots stored in static fields.</p>
<p>When a garbage collection starts, it assumes that all objects in the heap are garbage. </p>
<p>In other words, it is assumed that the thread’s stack contains no variables that refer to objects in the heap, that no CPU registers refer to objects in the heap, and that no static fields refer to objects<br>in the heap. </p>
<p>The garbage collector starts what is called the marking phase of the collection.</p>
<p>This is when the collector walks up the thread’s stack checking all of the roots. </p>
<p>If a root is found to refer to an object, a bit will be turned on in the object’s sync block index field-this is how the object is marked. </p>
<p>For example, the garbage collector might locate a local variable that points to an object in the heap. </p>
<p>Figure 20-3 shows a heap containing several allocated objects, and the application’s roots refer directly to objects A, C, D, and F. </p>
<p>All of these objects are marked. </p>
<p>When marking object D, the garbage collector notices that this object contains a field that refers to object H, causing object H to be marked as well. </p>
<p>The garbage collector continues to walk through all reachable objects recursively.</p>
<p>After a root and the objects referenced by its fields are marked, the garbage collector checks the next root and continues marking objects. </p>
<p>If the garbage collector is going to mark an object that it previously marked, it can stop walking down that path. </p>
<p>This behavior serves two purposes. </p>
<p>First, performance is enhanced significantly because the garbage collector doesn’t walk through a set of objects more than once.<br>Second, infinite loops are prevented if you have any circular linked lists of objects.</p>
<p>Once all of the roots have been checked, the heap contains a set of marked and unmarked objects. </p>
<p>The marked objects are reachable via the application’s code, and the unmarked objects are unreachable. </p>
<p>The unreachable objects are considered garbage, and the memory that they occupy can be reclaimed. </p>
<p>The garbage collector now starts what is called the compact phase of the collection. </p>
<p>This is when the collector traverses the heap linearly looking for contiguous blocks of unmarked (garbage) objects.</p>
<p>If small blocks are found, the garbage collector leaves the blocks alone. </p>
<p>If large free contiguous blocks are found, however, the garbage collector shifts the nongarbage objects down in memory to compact the heap.</p>
<p>Naturally, moving the objects in memory invalidates all variables and CPU registers that contain pointers to the objects. </p>
<p>So the garbage collector must revisit all of the application’s roots and modify them so that each root’s value points to the objects’ new memory location. </p>
<p>In addition, if any object contains a field that refers to another moved object, the garbage collector is responsible for correcting these fields as well. After the heap memory is compacted, the<br>managed heap’s NextObjPtr pointer is set to point to a location just after the last nongarbage object. </p>
<p>Figure 20-4 shows the managed heap after a collection.</p>
<p>As you can see, a garbage collection generates a considerable performance hit, which is the major downside of using a managed heap. </p>
<p>But keep in mind that garbage collections occur only when generation 0 is full, and until then, the managed heap is significantly faster than a C-runtime heap. </p>
<p>Finally, the CLR’s garbage collector offers some optimizations that greatly improve the performance of garbage collection. </p>
<p>I’ll discuss these optimizations later in this chapter, in the “Generations” and “Other Garbage Collector Performance Topics” sections.</p>
<p>As a programmer, you should take away a couple of important points from this discussion.</p>
<p>To start, you no longer have to implement any code to manage the lifetime of objects your application uses. </p>
<p>And notice how the two bugs described at the beginning of this chapter no longer exist. </p>
<p>First, it’s not possible to leak objects because any object not accessible from your application’s roots can be collected at some point.<br>Second, it’s not possible to access an object that is freed because the object won’t be freed if it is reachable, and if it’s not reachable, your application has no way to access it. </p>
<p>Also, since a collection causes memory compaction, it is not possible for managed objects to fragment your process’ virtual address space. </p>
<p>This would sometimes be a severe problem with unmanaged heaps but is no longer an issue when using the managed heap. </p>
<p>Using large objects (discussed later in this chapter) is an exception to this, and fragmentation of the large object heap is possible.</p>
<p>Note:</p>
<p>If garbage collection is so great, you might be wondering why it isn’t in ANSI C++. </p>
<p>The reason is that a garbage collector must be able to identify an application’s roots and must also be able to find all object pointers. </p>
<p>The problem with unmanaged C++ is that it allows casting a pointer from one type to another, and there’s no way to know what a pointer refers to. </p>
<p>In the CLR, the managed heap always knows the actual type of an object and uses the metadata information to determine which members of an object refer to other objects.</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/02/14/essentialcsharpchapter18/" itemprop="url">
                Essential C# 5.0 Note - Chapter 18 & 19 - MultiThreading
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-02-14T22:08:49+00:00" content="2016-02-14">
            2016-02-14
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="How_many_ways_for_multi-thread_synchronisation">How many ways for multi-thread synchronisation</h2><p>For all other data types and non thread-safe resources, multithreading can only be safely performed using the <strong>constructs</strong> in this topic</p>
<h3 id="Lock">Lock</h3><p>The <strong>lock</strong> (C#) statements can be used to ensure that a block of code runs to completion without interruption by other threads. </p>
<h4 id="Lock_on_an_object">Lock on an object</h4><p>This is accomplished by obtaining a mutual-exclusion lock for a given object for the duration of the code block.</p>
<p>A <strong>lock</strong> statement is given an object as an argument, and is followed by a code block that is to be executed by only one thread at a time. For example:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestThreading</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> System.Object lockThis = <span class="keyword">new</span> System.Object();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Process</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">lock</span> (lockThis)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Access thread-sensitive resources.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <strong>argument</strong> provided to the <strong>lock</strong> keyword must be <strong>an object</strong> based on a reference type, and is used to <strong>define the scope of the lock</strong>. </p>
<p>In the example above, the lock scope is limited to this function because <strong>no references to the object <code>lockThis</code> exist outside the function</strong>.</p>
<p><strong>If such a reference did exist, lock scope would extend to that object</strong>.</p>
<p>Strictly speaking, the object provided is used solely to <strong>uniquely identify the resource being shared among multiple threads</strong>, so it can be <strong>an arbitrary class instance</strong>. </p>
<p>In practice, however, this object usually represents <strong>the resource for which thread synchronization is necessary</strong>.</p>
<blockquote>
<p><strong>E.G</strong> For example, if a container object is to be used by multiple threads, then the container can be passed to lock, and the synchronized code block following the lock would access the container. </p>
</blockquote>
<p>As long as other threads locks on the same contain before accessing it, then access to the object is safely synchronized.</p>
<p>Generally, it is <strong>best to avoid</strong><br>1.locking on a public type<br>2.locking on object instances beyond the control of your application. </p>
<blockquote>
<p><strong>E.G</strong> For example, lock(this) can be problematic if the instance can be accessed publicly, because code beyond your control may lock on the object as well. </p>
</blockquote>
<p>This could create deadlock situations where two or more threads wait for the release of the same object. </p>
<h4 id="Lock_on_public_data_type">Lock on public data type</h4><p>Locking on a public data type, as opposed to an object, can cause problems for the same reason. </p>
<blockquote>
<p><strong>E.G</strong> Locking on literal strings is especially risky because literal strings are interned by the common language runtime (CLR). </p>
</blockquote>
<p>This means that there is one instance of any given string literal for the entire program, the exact same object represents the literal in all running application domains, on all threads. </p>
<p>As a result, a lock placed on a string with the same contents anywhere in the application process locks all instances of that string in the application. </p>
<p>As a result, it is best to lock a private or protected member that is not interned. </p>
<p>Some classes provide members specifically for locking. </p>
<p>The Array type, for example, provides SyncRoot. Many collection types provide a SyncRoot member as well.</p>
<p>The <strong>lock</strong> keyword marks a statement block as a critical section by obtaining the mutual-exclusion lock for a given object, executing a statement, and then releasing the lock. </p>
<p>The following example includes a lock statement.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Account</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">decimal</span> balance;</span><br><span class="line">    <span class="keyword">private</span> Object thisLock = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Withdraw</span>(<span class="params"><span class="keyword">decimal</span> amount</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">lock</span> (thisLock)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (amount &gt; balance)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Insufficient funds"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            balance -= amount;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <strong>lock</strong> keyword ensures that one thread does not enter a critical section of code while another thread is in the critical section. If another thread tries to enter a locked code, it will wait, block, until the object is released.</p>
<p>The section Threading (C# and Visual Basic) discusses threading.</p>
<p>The <strong>lock</strong> keyword calls Enter at the start of the block and Exit at the end of the block. A ThreadInterruptedException is thrown if Interrupt interrupts a thread that is waiting to enter a lock statement.</p>
<p>In general, avoid locking on a public type, or instances beyond your code’s control. The common constructs lock (this), lock (typeof (MyType)), and lock (“myLock”) violate this guideline:<br><em>lock (this) is a problem if the instance can be accessed publicly.
</em>lock (typeof (MyType)) is a problem if MyType is publicly accessible.<br>*lock(“myLock”) is a problem because any other code in the process using the same string, will share the same lock.</p>
<p>Best practice is to define a private object to lock on, or a private static object variable to protect data common to all instances.</p>
<p>You can’t use the await keyword in the body of a lock statement.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//using System.Threading;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">ThreadTest</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RunMe</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">"RunMe called"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        ThreadTest b = <span class="keyword">new</span> ThreadTest();</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(b.RunMe);</span><br><span class="line">        t.Start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Output: RunMe called</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The following sample uses threads and lock. As long as the lock statement is present, the // statement block is a critical section and balance will never become a negative number.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Account</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Object thisLock = <span class="keyword">new</span> Object();</span><br><span class="line">    <span class="keyword">int</span> balance;</span><br><span class="line"></span><br><span class="line">    Random r = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Account</span>(<span class="params"><span class="keyword">int</span> initial</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        balance = initial;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Withdraw</span>(<span class="params"><span class="keyword">int</span> amount</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// This condition never is true unless the lock statement</span></span><br><span class="line">        <span class="comment">// is commented out.</span></span><br><span class="line">        <span class="keyword">if</span> (balance &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Negative Balance"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Comment out the next line to see the effect of leaving out </span></span><br><span class="line">        <span class="comment">// the lock keyword.</span></span><br><span class="line">        <span class="keyword">lock</span> (thisLock)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (balance &gt;= amount)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"Balance before Withdrawal :  "</span> + balance);</span><br><span class="line">                Console.WriteLine(<span class="string">"Amount to Withdraw        : -"</span> + amount);</span><br><span class="line">                balance = balance - amount;</span><br><span class="line">                Console.WriteLine(<span class="string">"Balance after Withdrawal  :  "</span> + balance);</span><br><span class="line">                <span class="keyword">return</span> amount;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// transaction rejected</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoTransactions</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Withdraw(r.Next(<span class="number">1</span>, <span class="number">100</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Test</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Thread[] threads = <span class="keyword">new</span> Thread[<span class="number">10</span>];</span><br><span class="line">        Account acc = <span class="keyword">new</span> Account(<span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Thread t = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(acc.DoTransactions));</span><br><span class="line">            threads[i] = t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            threads[i].Start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Monitors">Monitors</h3><p>Like the lock and SyncLock keywords, <strong>monitors</strong> prevent blocks of code from simultaneous execution by multiple threads. </p>
<p>The <strong>Enter</strong> method allows <strong>one and only one</strong> thread to proceed into the following statements; all other threads are blocked until the executing thread calls <strong>Exit</strong>. </p>
<p>This is just like using the lock keyword.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">lock</span> (x)</span><br><span class="line">&#123;</span><br><span class="line">    DoSomething();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.Object obj = (System.Object)x;</span><br><span class="line">System.Threading.Monitor.Enter(obj);</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    DoSomething();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">&#123;</span><br><span class="line">    System.Threading.Monitor.Exit(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Using the <strong>lock</strong> (C#) keyword is generally <strong>preferred over</strong> using the <strong>Monitor</strong> class directly, both because </p>
<ol>
<li>lock or SyncLock is more concise (adj. 简明的，简洁的; ; 简约; 精炼), </li>
<li>And because lock or SyncLock insures that the underlying monitor is released, even if the protected code throws an exception. This is accomplished (by “exit”) with the finally keyword, which executes its associated code block regardless of whether an exception is thrown.</li>
</ol>
<h3 id="Synchronization_Events_and_Wait_Handles">Synchronization Events and Wait Handles</h3><p>Using a lock or monitor is useful for preventing the simultaneous execution of thread-sensitive blocks of code, but these constructs do not allow one thread to <strong>communicate an event to another</strong>. </p>
<p>This requires synchronization events, which are objects that have one of two states, <strong>signaled</strong> and <strong>un-signaled</strong>, that can be used to <strong>activate</strong> and <strong>suspend threads</strong>. </p>
<p>Threads can be <strong>suspended</strong> by being made to wait on <strong>a synchronization event</strong> that is <strong>unsignaled</strong>, and can be <strong>activated</strong> by changing <strong>the event state</strong> to <strong>signaled</strong>. </p>
<p>If a thread attempts to wait on an event that is already signaled, then the thread continues to execute without delay.</p>
<p>There are two kinds of synchronization events:<br><em>AutoResetEvent
</em>ManualResetEvent</p>
<p>They differ only in that <strong>AutoResetEvent</strong> changes from <strong>signaled to unsignaled automatically any time it activates a thread</strong>. </p>
<p>Conversely, a <strong>ManualResetEvent</strong> allows any number of threads to be <strong>activated by its signaled state</strong>, and will only revert to <strong>an unsignaled state</strong> when its <strong>Reset method is called</strong>.</p>
<p>Threads can be made to wait on events by calling one of the wait methods, such as <strong>WaitOne</strong>, <strong>WaitAny</strong>, or <strong>WaitAll</strong>. </p>
<p><em>WaitHandle.WaitOne causes the thread to wait until a single event becomes signaled, </em>WaitHandle.WaitAny blocks a thread until one or more indicated events become signaled, *WaitHandle.WaitAll blocks the thread until all of the indicated events become signaled. </p>
<p>An event becomes signaled when its <strong>Set</strong> method is called.</p>
<p>In the following example, a thread is created and started by the Main function. </p>
<p>The new thread waits on an event using the WaitOne method. </p>
<p>The thread is suspended until the event becomes signaled by the primary thread that is executing the Main function. </p>
<p>Once the event becomes signaled, the auxiliary thread returns. </p>
<p>In this case, because the event is only used for one thread activation, either the AutoResetEvent or ManualResetEvent classes could be used.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">ThreadingExample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> AutoResetEvent autoEvent;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoWork</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Console.WriteLine(<span class="string">"   worker thread started, now waiting on event..."</span>);</span><br><span class="line">        autoEvent.WaitOne();</span><br><span class="line">        Console.WriteLine(<span class="string">"   worker thread reactivated, now exiting..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        autoEvent = <span class="keyword">new</span> AutoResetEvent(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">"main thread starting worker thread..."</span>);</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread(DoWork);</span><br><span class="line">        t.Start();</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">"main thread sleeping for 1 second..."</span>);</span><br><span class="line">        Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">        Console.WriteLine(<span class="string">"main thread signaling worker thread..."</span>);</span><br><span class="line">        autoEvent.Set();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Mutex_Object">Mutex Object</h3><p>A mutex is similar to a monitor; it prevents the simultaneous execution of a block of code by more than one thread at a time. In fact, the name “mutex” is a shortened form of the term “mutually exclusive.” </p>
<p>Unlike monitors, however, a <strong>mutex</strong> can be used to <strong>synchronize threads across processes</strong>. </p>
<p>A mutex is represented by the <strong>Mutex class</strong>.</p>
<p>When used for <strong>inter-process synchronization</strong>, a mutex is called a <strong>named mutex</strong> because it is to be used in <strong>another application</strong>, and therefore it cannot be <strong>shared by means of a global or static variable</strong>. </p>
<p>It must be given a <strong>name</strong> so that both applications can access the <strong>same mutex object</strong>.</p>
<p>Although a mutex can be used for intra-process thread synchronization, using <strong>Monitor</strong> is generally preferred, because monitors were <strong>designed specifically for the .NET Framework and therefore make better use of resources</strong>.</p>
<p>In contrast, the <strong>Mutex class</strong> is a wrapper to a <strong>Win32 construct</strong>. </p>
<p>While it is more powerful than a monitor, a mutex requires interop transitions that are more computationally expensive than those required by the Monitor class. </p>
<p>For an example of using a mutex, see Mutexes.</p>
<h3 id="Interlocked">Interlocked</h3><p>For simple operations on integral numeric data types, synchronizing threads can be accomplished with members of the Interlocked class.</p>
<p>You can use the methods of the Interlocked class to prevent problems that can occur <strong>when multiple threads attempt to simultaneously update or compare the same value</strong>. </p>
<p>The methods of this class let you <strong>safely increment, decrement, exchange, and compare values from any thread</strong>.</p>
<p>The methods of this class help protect against errors that can occur when the scheduler switches contexts while a thread is updating a variable that can be accessed by other threads, or when two threads are executing concurrently on separate processors. </p>
<p>The members of this class do not throw exceptions.</p>
<p>The Increment and Decrement methods increment or decrement a variable and store the resulting value in a single operation. </p>
<p>On most computers, incrementing a variable is not an atomic operation, requiring the following steps:<br>1.Load a value from an instance variable into a register.<br>2.Increment or decrement the value.<br>3.Store the value in the instance variable.</p>
<p>If you do not use Increment and Decrement, a thread can be preempted after executing the first two steps.</p>
<p>Another thread can then execute all three steps. When the first thread resumes execution, it overwrites the value in the instance variable, and the effect of the increment or decrement performed by the second thread is lost.</p>
<p>The Exchange method atomically exchanges the values of the specified variables. </p>
<p>The CompareExchange method combines two operations: comparing two values and storing a third value in one of the variables, based on the outcome of the comparison. </p>
<p>The compare and exchange operations are performed as an atomic operation.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">InterlockedExchange_Example</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">MyInterlockedExchangeExampleClass</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//0 for false, 1 for true.</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> usingResource = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">int</span> numThreadIterations = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">int</span> numThreads = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            Thread myThread;</span><br><span class="line">            Random rnd = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numThreads; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                myThread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> ThreadStart(MyThreadProc));</span><br><span class="line">                myThread.Name = String.Format(<span class="string">"Thread&#123;0&#125;"</span>, i + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Wait a random amount of time before starting next thread.</span></span><br><span class="line">                Thread.Sleep(rnd.Next(<span class="number">0</span>, <span class="number">1000</span>));</span><br><span class="line">                myThread.Start();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MyThreadProc</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numThreadIterations; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                UseResource();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Wait 1 second before next attempt.</span></span><br><span class="line">                Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//A simple method that denies reentrancy.</span></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">UseResource</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="comment">//0 indicates that the method is not in use.</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="number">0</span> == Interlocked.Exchange(<span class="keyword">ref</span> usingResource, <span class="number">1</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"&#123;0&#125; acquired the lock"</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Code to access a resource that is not thread safe would go here.</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//Simulate some work</span></span><br><span class="line">                Thread.Sleep(<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">                Console.WriteLine(<span class="string">"&#123;0&#125; exiting lock"</span>, Thread.CurrentThread.Name);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//Release the lock</span></span><br><span class="line">                Interlocked.Exchange(<span class="keyword">ref</span> usingResource, <span class="number">0</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"   &#123;0&#125; was denied the lock"</span>, Thread.CurrentThread.Name);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ReaderWriter_Locks">ReaderWriter Locks</h3><p>In some cases, you may want to lock a resource only when data is being written and permit multiple clients to simultaneously read data when data is not being updated. </p>
<p>The <strong>ReaderWriterLock</strong> class enforces <strong>exclusive access to a resource while a thread is modifying the resource</strong>, but it allows <strong>non-exclusive access when reading the resource</strong>. </p>
<p><strong>ReaderWriter</strong> locks are a useful alternative to exclusive locks, which cause other threads to wait, even when those threads do not need to update data.</p>
<h3 id="Deadlocks">Deadlocks</h3><p>Thread synchronization is invaluable in multithreaded applications, but there is always the danger of creating a <strong>deadlock</strong>, where multiple threads are waiting for each other and the application comes to a <strong>halt</strong>. </p>
<p>A deadlock is analogous to a situation in which cars are stopped at a four-way stop and each person is waiting for the other to go. </p>
<p>Avoiding deadlocks is important; the key is careful planning. </p>
<p>You can often predict deadlock situations by <strong>diagramming multithreaded applications before you start coding</strong>.</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/02/14/essentialcsharpchapter12/" itemprop="url">
                Essential C# 5.0 Note - Chapter 12 - Delegates
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-02-14T21:46:13+00:00" content="2016-02-14">
            2016-02-14
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p><strong>Delegates</strong> - passing a reference to one method as an argument to another method.</p>
<p><strong>Delegates</strong> - allow you to capture a reference to a method and pass it around like any other object, and to call the captured method like any other method.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">DelegateSample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">delegate</span> <span class="keyword">bool</span> <span class="title">ComparisonHandler</span>(<span class="params"><span class="keyword">int</span> first, <span class="keyword">int</span> second</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BubbleSort</span>(<span class="params"></span><br><span class="line">        <span class="keyword">int</span>[] items, ComparisonHandler comparisonMethod</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">int</span> j;</span><br><span class="line">        <span class="keyword">int</span> temp;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (comparisonMethod == <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">"comparisonMethod"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (items == <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = items.Length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (comparisonMethod(items[j - <span class="number">1</span>], items[j]))</span><br><span class="line">                &#123;</span><br><span class="line">                    temp = items[j - <span class="number">1</span>];</span><br><span class="line">                    items[j - <span class="number">1</span>] = items[j];</span><br><span class="line">                    items[j] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">GreaterThan</span>(<span class="params"><span class="keyword">int</span> first, <span class="keyword">int</span> second</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> first &gt; second;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">AlphabeticalGreaterThan</span>(<span class="params"><span class="keyword">int</span> first, <span class="keyword">int</span> second</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> comparison;</span><br><span class="line">        comparison = (first.ToString().CompareTo(second.ToString()));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> comparison &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">int</span>[] items = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; items.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(<span class="string">"Enter an integer: "</span>);</span><br><span class="line">            items[i] = <span class="keyword">int</span>.Parse(Console.ReadLine());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BubbleSort(items, AlphabeticalGreaterThan);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        BubbleSort(items,</span><br><span class="line">          (<span class="keyword">int</span> first, <span class="keyword">int</span> second) =&gt;</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">return</span> first &lt; second;</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; items.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(items[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Console.ReadLine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/02/14/essentialcsharpchapter17/" itemprop="url">
                Essential C# 5.0 Note - Chapter 17 - Reflection, Attributes, and Dynamic Programming
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-02-14T21:43:37+00:00" content="2016-02-14">
            2016-02-14
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>Reflection can be used for observing and modifying program execution at runtime. </p>
<p>A reflection-oriented program component can monitor the execution of an enclosure of code and can modify itself according to a desired goal related to that enclosure. </p>
<p>This is typically accomplished by dynamically assigning program code at runtime.</p>
<p>In object oriented programming languages such as Java, reflection allows inspection of classes, interfaces, fields and methods at runtime without knowing the names of the interfaces, fields, methods at compile time. </p>
<p>It also allows instantiation of new objects and invocation of methods.</p>
<p>Reflection can also be used to adapt a given program to different situations dynamically.</p>
<p>For example, consider an application that uses two different classes X and Y interchangeably to perform similar operations.</p>
<p>Without reflection-oriented programming, the application might be hard-coded to call method names of class X and class Y. </p>
<p>However, using the reflection-oriented programming paradigm, the application could be designed and written to utilize reflection in order to invoke methods in classes X and Y without hard-coding method names. </p>
<p>Reflection-oriented programming almost always requires additional knowledge, framework, relational mapping, and object relevance in order to take advantage of more generic code execution.</p>
<p>Reflection is often used as part of software testing, such as for the runtime creation/instantiation of mock objects.</p>
<p>Reflection is also a key strategy for metaprogramming.</p>
<p>In some object-oriented programming languages, such as C# and Java, reflection can be used to override member accessibility rules. </p>
<p>For example, reflection makes it possible to change the value of a field marked “private” in a third-party library’s class.</p>
<h4 id="Implementation">Implementation</h4><p>A language supporting reflection provides a number of features available at runtime that would otherwise be difficult to accomplish in a lower-level language. </p>
<p>Some of these features are the abilities to:</p>
<ul>
<li><p>Discover and modify source code constructions (such as code blocks, classes, methods, protocols, etc.) as a first-class object at runtime.</p>
</li>
<li><p>Convert a string matching the symbolic name of a class or function into a reference to or invocation of that class or function.</p>
</li>
<li><p>Evaluate a string as if it were a source code statement at runtime.</p>
</li>
<li><p>Create a new interpreter for the language’s bytecode to give a new meaning or purpose for a programming construct.</p>
</li>
</ul>
<p>These features can be implemented in different ways.</p>
<p>In MOO, reflection forms a natural part of everyday programming idiom. </p>
<p>When verbs (methods) are called, various variables such as verb (the name of the verb being called) and this (the object on which the verb is called) are populated to give the context of the call.</p>
<p>Security is typically managed by accessing the caller stack programmatically:</p>
<p>Since callers() is a list of the methods by which the current verb was eventually called, performing tests on callers()[1] (the command invoked by the original user) allows the verb to protect itself against unauthorised use.</p>
<p>Compiled languages rely on their runtime system to provide information about the source code. </p>
<p>A compiled Objective-C executable, for example, records the names of all methods in a block of the executable, providing a table to correspond these with the underlying methods (or selectors for these methods) compiled into the program. </p>
<p>In a compiled language that supports runtime creation of functions, such as Common Lisp, the runtime environment must include a compiler or an interpreter.</p>
<p>Reflection can be implemented for languages not having built-in reflection facilities by using a program transformation system to define automated source code changes.</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/02/11/essentialcsharpchaptersix/" itemprop="url">
                Essential C# 5.0 Note - Chapter 6 - Inheritance (Notes)
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-02-11T04:31:37+00:00" content="2016-02-11">
            2016-02-11
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h3 id="Inheritance">Inheritance</h3><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PdaItem</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> DateTime LastUpdated &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Contact</span> : <span class="title">PdaItem</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Address &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Phone &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Appointment</span> : <span class="title">PdaItem</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Customer</span> : <span class="title">Contact</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span><br><span class="line">  </span>&#123;</span><br><span class="line">      <span class="comment">// Derived types can be implicitly converted to</span></span><br><span class="line">      <span class="comment">// base types</span></span><br><span class="line">      Contact contact = <span class="keyword">new</span> Contact();</span><br><span class="line">      PdaItem item = contact;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// Base types must be cast explicitly to derived types</span></span><br><span class="line">      contact = (Contact)item;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The derived type, Contact, is a PdaItem and can be assigned directly to a variable of type PdaItem. </p>
<p>This is known as an <strong>implicit conversion</strong> because no cast operator is required and the conversion will, on principle, always succeed; it will not throw an exception.</p>
<p>The reverse, however, is not true. </p>
<p>A PdaItem is not necessarily a Contact; it could be an Appointment or some other derived type. </p>
<p>Therefore, casting from the base type to the derived type requires an <strong>explicit cast</strong>, which at runtime could fail. </p>
<p>To perform an explicit cast, identify the target type within parentheses prior to the original reference.</p>
<p>An implicit conversion to a base class <strong>does not instantiate a new instance</strong>. </p>
<p>Instead, the same instance is <strong>simply referred to as the base type</strong> and the capabilities (the accessible members) are those of the base type.</p>
<p>Similarly, casting down from the base class to the derived class simply begins referring to the type more specifically, expanding the available operations. </p>
<p>The restriction is that the actual instantiated type must be an instance of the targeted type (or something derived from it).</p>
<blockquote>
<p>Defining Custom Conversions</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">GPSCoordinates</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">implicit</span> <span class="keyword">operator</span> <span class="title">UTMCoordinates</span>(<span class="params"></span><br><span class="line">      GPSCoordinates coordinates</span>)</span><br><span class="line">  </span>&#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Private_Access_Modifier">Private Access Modifier</h4><blockquote>
<p>Non-nested derived classes cannot access members declared as private in a base class.</p>
</blockquote>
<h4 id="Protected_Access_Modifier">Protected Access Modifier</h4><blockquote>
<p>Protected members in the base class are only accessible from the base class and other classes within the derivation chain.</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Contact</span> : <span class="title">PdaItem</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Save</span>(<span class="params"></span>)</span><br><span class="line">  </span>&#123;</span><br><span class="line">      <span class="comment">// Instantiate a FileStream using &lt;ObjectKey&gt;.dat</span></span><br><span class="line">      <span class="comment">// for the filename.</span></span><br><span class="line">      FileStream stream = System.IO.File.OpenWrite(</span><br><span class="line">          ObjectKey + <span class="string">".dat"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Load</span>(<span class="params">PdaItem pdaItem</span>)</span><br><span class="line">  </span>&#123;</span><br><span class="line">      <span class="comment">// ERROR:  'pdaItem.ObjectKey' is inaccessible</span></span><br><span class="line">      <span class="comment">// due to its protection level</span></span><br><span class="line">      <span class="comment">// pdaItem.ObjectKey = ...;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Contact contact = pdaItem <span class="keyword">as</span> Contact;</span><br><span class="line">      <span class="keyword">if</span>(contact != <span class="keyword">null</span>)</span><br><span class="line">      &#123;</span><br><span class="line">          contact.ObjectKey = ...;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A subtlety shown in the Contact.Load() method is worth noting. Developers are often surprised that from code within Contact it is not possible to access the protected ObjectKey of an explicit PdaItem, even though Contact derives from PdaItem. The reason is that a PdaItem could potentially be an Address, and Contact should not be able to access protected members of Address. Therefore, encapsulation prevents Contact from potentially modifying the ObjectKey of an Address. A successful cast to Contact will bypass the restriction as shown. The governing rule is that accessing a protected member from a derived class requires compile-time determination that the protected member is an instance of the derived class (or a class further derived from it).</p>
<h4 id="Extension_Methods">Extension Methods</h4><blockquote>
<p>We cover interfaces and how to use them with extension methods in the next chapter.</p>
</blockquote>
<h4 id="Single_Inheritance">Single Inheritance</h4><blockquote>
<p>C# is a <strong>single-inheritance</strong> programming language (as is the CIL language to which C# compiles). </p>
<p>For the rare cases that require a multiple-inheritance class structure, one solution is to use <strong>aggregation</strong><br>; instead of one class inheriting from another, one class contains an instance of the other. </p>
</blockquote>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/01/18/backendtest/" itemprop="url">
                Backend Interview Questions
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on
          <time itemprop="dateCreated" datetime="2016-01-18T12:13:17+00:00" content="2016-01-18">
            2016-01-18
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h3 id="SOLID"><a href="../2015/09/21/SOLIDPrinciples/">SOLID</a></h3><h3 id="Generics"><a href="../2015/11/20/essentialcsharpchaptereleven/">Generics</a></h3><h3 id="DI_with_IOC">DI with IOC</h3><ul>
<li>What’s DI ?</li>
<li>What’s IOC container ?</li>
<li>What’s the benfits of IOC container ?</li>
<li>IOC container decides which implement to be put in DI</li>
<li>Which IOC container u using ?</li>
</ul>
<h4 id="IOC:">IOC:</h4><p>In traditional programming, the custom code that expresses the purpose of the program calls into reusable libraries to take care of generic tasks, but with inversion of control, it is the reusable code that calls into the custom, or task-specific, code.</p>
<p><strong> Description </strong><br>In traditional programming, the flow of the business logic is determined by objects that are statically bound to one another. With inversion of control, the flow depends on the object graph that is built up during program execution. Such a dynamic flow is made possible by object interactions being defined through abstractions. This run-time binding is achieved by mechanisms such as dependency injection or a service locator. In IoC, the code could also be linked statically during compilation, but finding the code to execute by reading its description from external configuration instead of with a direct reference in the code itself.</p>
<p>In dependency injection, a dependent object or module is coupled to the object it needs at run time. Which particular object will satisfy the dependency during program execution typically cannot be known at compile time using static analysis. While described in terms of object interaction here, the principle can apply to other programming methodologies besides object-oriented programming.</p>
<p>In order for the running program to bind objects to one another, the objects must possess compatible interfaces. For example, class A may delegate behavior to interface I which is implemented by class B; the program instantiates A and B, and then injects B into A.</p>
<p><strong> Benfits </strong><br>Inversion of control serves the following design purposes:</p>
<p>To decouple the execution of a task from implementation.<br>To focus a module on the task it is designed for.<br>To free modules from assumptions about how other systems do what they do and instead rely on contracts.<br>To prevent side effects when replacing a module.</p>
<p>Inversion of control is sometimes facetiously referred to as the “Hollywood Principle: Don’t call us, we’ll call you”.</p>
<p><strong> How to implement </strong><br>In object-oriented programming, there are several basic techniques to implement inversion of control. These are:</p>
<ol>
<li>Using a factory pattern</li>
<li>Using a service locator pattern</li>
<li>Using a dependency injection, for example<ul>
<li>A constructor injection</li>
<li>A parameter injection</li>
<li>A setter injection</li>
<li>An interface injection</li>
</ul>
</li>
<li>Using a contextualized lookup</li>
<li>Using template method design pattern</li>
<li>Using strategy design pattern</li>
</ol>
<h4 id="DI">DI</h4><p>A dependency is an object that can be used (a service). An injection is the passing of a dependency to a dependent object (a client) that would use it. The service is made part of the client’s state. Passing the service to the client, rather than allowing a client to build or find the service, is the fundamental requirement of the pattern.</p>
<p>Dependency injection allows a program design to follow the dependency inversion principle. The client delegates to external code (the injector) the responsibility of providing its dependencies. The client is not allowed to call the injector code.[2] It is the injecting code that constructs the services and calls the client to inject them. This means the client code does not need to know about the injecting code. The client does not need to know how to construct the services. The client does not need to know which actual services it is using. The client only needs to know about the intrinsic interfaces of the services because these define how the client may use the services. This separates the responsibilities of use and construction.</p>
<p><strong> Taxonomy </strong></p>
<p>Inversion of Control (IoC) is more general than DI. Put simply, IoC means letting other code call you rather than insisting on doing the calling. An example of IoC without DI is the template pattern. Here polymorphism is achieved through subclassing, that is, inheritance.</p>
<p>Dependency injection implements IoC through composition so is often identical to that of the strategy pattern, but while the strategy pattern is intended for dependencies to be interchangeable throughout an object’s lifetime, in dependency injection it may be that only a single instance of a dependency is used. This still achieves polymorphism, but through delegation and composition.</p>
<p>Advantages</p>
<ul>
<li>Dependency injection allows a client the flexibility of being configurable. Only the client’s behavior is fixed. The client may act on anything that supports the intrinsic interface the client expects.</li>
<li>Dependency injection can be used to externalize a system’s configuration details into configuration files allowing the system to be reconfigured without recompilation. Separate configurations can be written for different situations that require different implementations of components. This includes, but is not limited to, testing.</li>
<li>Because dependency injection doesn’t require any change in code behavior it can be applied to legacy code as a refactoring. The result is clients that are more independent and that are easier to unit test in isolation using stubs or mock objects that simulate other objects not under test. This ease of testing is often the first benefit noticed when using dependency injection.</li>
<li>Dependency injection allows a client to remove all knowledge of a concrete implementation that it needs to use. This helps isolate the client from the impact of design changes and defects. It promotes reusability, testability and maintainability.</li>
<li>Reduction of boilerplate code in the application objects since all work to initialize or set up dependencies is handled by a provider component.</li>
<li>Dependency injection allows concurrent or independent development. Two developers can independently develop classes that use each other, while only needing to know the interface the classes will communicate through. Plugins are often developed by third party shops that never even talk to the developers who created the product that uses the plugins.</li>
<li>Dependency Injection decreases coupling between a class and its dependency.</li>
</ul>
<p>Disadvantages</p>
<ul>
<li>Dependency injection creates clients that demand configuration details be supplied by construction code. This can be onerous when obvious defaults are available.</li>
<li>Dependency injection can make code difficult to trace (read) because it separates behavior from construction. This means developers must refer to more files to follow how a system performs.</li>
<li>Dependency injection typically requires more upfront development effort since one can not summon into being something right when and where it is needed but must ask that it be injected and then ensure that it is injected.</li>
<li>Dependency injection can cause an explosion of types, especially in languages that have explicit interface types, like Java and C#</li>
<li>Dependency injection forces complexity to move out of classes and into the linkages between classes which might not always be desirable or easily managed.</li>
<li>Ironically, dependency injection can encourage dependence on a dependency injection framework.</li>
</ul>
<p>Dependency injection is a specific type of IoC using contextualized lookup</p>
<p>Such a dynamic flow is made possible by object interactions being defined through abstractions.<br>This runtime binding is achieved by mechanisms such as dependency injection or a service<br>locator . In IoC the code could also be linked statically during compilation, but finding the code to<br>execute by reading its description from external configuration instead of with a direct reference<br>in the code itself.</p>
<p>In dependency injection, a dependent object or module is coupled to the object it needs at run<br>time . Which particular object will satisfy the dependency during program execution typically<br>cannot be known at compile time using static analysis . While described in terms of object<br>interaction here, the principle can apply to other programming methodologies besides<br>objectoriented programming .</p>
<p>In order for the running program to bind objects to one another, the objects must possess<br>compatible interfaces . For example, class A may delegate behavior to interface I which is<br>implemented by class B; the program instantiates A and B, and then injects B to A.</p>
<h4 id="Interface_injection_comparison">Interface injection comparison</h4><p>The advantage of interface injection is that dependencies can be completely ignorant of their clients yet can still receive a reference to a new client and, using it, send a reference-to-self back to the client. In this way, the dependencies become injectors. The key is that the injecting method (which could just be a classic setter method) is provided through an interface.</p>
<p>An assembler is still needed to introduce the client and its dependencies. The assembler would take a reference to the client, cast it to the setter interface that sets that dependency, and pass it to that dependency object which would turn around and pass a reference-to-self back to the client.</p>
<p>For interface injection to have value, the dependency must do something in addition to simply passing back a reference to itself. This could be acting as a factory or sub-assembler to resolve other dependencies, thus abstracting some details from the main assembler. It could be reference-counting so that the dependency knows how many clients are using it. If the dependency maintains a collection of clients, it could later inject them all with a different instance of itself.</p>
<p>Interface injection[edit]<br>This is simply the client publishing a role interface to the setter methods of the client’s dependencies. It can be used to establish how the injector should talk to the client when injecting dependencies.</p>
<p>// Service setter interface.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ServiceSetter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setService</span><span class="params">(Service service)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Client class</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> <span class="keyword">implements</span> <span class="title">ServiceSetter</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Internal reference to the service used by this client.</span></span><br><span class="line">    <span class="keyword">private</span> Service service;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set the service that this client is to use.</span></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setService</span><span class="params">(Service service)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.service = service;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="MVC">MVC</h3><p><strong> The ASP.NET MVC framework offers the following advantages:</strong></p>
<ul>
<li><p>It makes it easier to manage complexity by dividing an application into the model, the<br>view, and the controller.</p>
</li>
<li><p>It does not use view state or serverbased forms. This makes the MVC framework ideal<br>for developers who want full control over the behavior of an application.</p>
</li>
<li><p>It uses a Front Controller pattern that processes Web application requests through a<br>single controller. This enables you to design an application that supports a rich routing<br>infrastructure. For more information, see Front Controller on the MSDN Web site.</p>
</li>
<li><p>It provides better support for testdriven development (TDD).</p>
</li>
<li><p>It works well for Web applications that are supported by large teams of developers and<br>Web designers who need a high degree of control over the application behavior.</p>
</li>
</ul>
<p>ChildAction,cant be call directly, generate PartialView</p>
<p>What’s view model.</p>
<p>View Model Validation. FlurentValidation. MVC dataAnnotation.</p>
<p>Repo, different layer structure.</p>
<p>Razor</p>
<h3 id="SQL_Server">SQL Server</h3><h4 id="Index">Index</h4><p>A database index is a data structure that improves the speed of data retrieval operations on a database table at the cost of additional writes and the use of more storage space to maintain the extra copy of data.</p>
<p>Indexes are used to quickly locate data without having to search every row in a database table every time a database table is accessed.</p>
<p>Indexes can be created using one or more columns of a database table , providing the basis for both rapid random lookups and efficient access of ordered records.</p>
<p>An index is a copy of select columns of data from a table that can be searched very efficiently that also includes a low level disk block address or direct link to the complete row of data it was copied from.</p>
<p>With a clustered index the rows are stored physically on the disk in the same order as the index. </p>
<p>There can therefore be only one clustered index.</p>
<p>With a non clustered index there is a second list that has pointers to the physical rows. You can have many non clustered indexes, although each new index will increase the time it takes to write new records.</p>
<p>It is generally faster to read from a clustered index if you want to get back all the columns. You do not have to go first to the index and then to the table.</p>
<p>Writing to a table with a clustered index can be slower, if there is a need to rearrange the data.</p>
<h4 id="Clustered">Clustered</h4><p>Clustering alters the data block into a certain distinct order to match the index, resulting in the row data being stored in order. Therefore, only one clustered index can be created on a given database table.</p>
<p>Clustered indices can greatly increase overall speed of retrieval, but usually only where the data is accessed sequentially in the same or reverse order of the clustered index, or when a range of items is selected.</p>
<p>Since the physical records are in this sort order on disk, the next row item in the sequence is immediately before or after the last one, and so fewer data block reads are required.</p>
<p>The primary feature of a clustered index is therefore the ordering of the physical data rows in accordance with the index blocks that point to them. Some databases separate the data and<br>index blocks into separate files, others put two completely different data blocks within the same physical file(s).</p>
<h4 id="Sql_Server_Profiler">Sql Server Profiler</h4><h3 id="EF_code_first">EF code first</h3><p>From .</p>
<p>Lazy loading and enger loading</p>
<p>Auto Mapper</p>
<h3 id="Agile_–_Collaborate,_Integrity,_Curious,_Rise_up_asap">Agile – Collaborate, Integrity, Curious, Rise up asap</h3><h3 id="SEO">SEO</h3><h4 id="SiteMap_+_Robots-txt">SiteMap + Robots.txt</h4><h4 id="Friendly_Url_+_Lower_case">Friendly Url + Lower case</h4><h4 id="Canonical_URL">Canonical URL</h4><h4 id="Minificatioin+bundling">Minificatioin+bundling</h4><h4 id="JS_CSS_Files_at_bottom_of_page">JS CSS Files at bottom of page</h4><h4 id="W3c_standard">W3c standard</h4><p><strong> Unique H1 </strong></p>
<h3 id="Security:">Security:</h3><h4 id="Xxs">Xxs</h4><h4 id="Sql_injection">Sql injection</h4><p>HttpPost and HttpGet 的 attitudes<br>[ ValidateAntiForgeryToken ]<br>[ ValidateInput ( false )]</p>
<h4 id="SSL">SSL</h4><h4 id="HTTPS">HTTPS</h4><h3 id="GC">GC</h3><p>In computer science , garbage collection ( GC ) is a form of automatic memory management .<br>The garbage collector , or just collector , attempts to reclaim garbage , or memory occupied by<br>objects that are no longer in use by the program . Garbage collection was invented by John<br>McCarthy around 1959 to solve problems in Lisp.</p>
<p>Garbage collection is often portrayed as the opposite of manual memory management , which<br>requires the programmer to specify which objects to deallocate and return to the memory<br>system. However, many systems use a combination of approaches, including other techniques<br>such as stack allocation and region inference . Like other memory management techniques,<br>garbage collection may take a significant proportion of total processing time in a program and<br>can thus have significant influence on performance.</p>
<p>Resources other than memory, such as network sockets , database handles , user interaction<br>windows, and file and device descriptors, are not typically handled by garbage collection.<br>Methods used to manage such resources, particularly destructors , may suffice to manage<br>memory as well, leaving no need for GC. Some GC systems allow such other resources to be<br>associated with a region of memory that, when collected, causes the other resource to be<br>reclaimed; this is called finalization . Finalization may introduce complications limiting its<br>usability, such as intolerable latency between disuse and reclaim of especially limited resources,<br>or a lack of control over which thread performs the work of reclaiming.</p>
<h4 id="Advantages">Advantages</h4><p>Garbage collection frees the programmer from manually dealing with memory deallocation. As a<br>result, certain categories of bugs are eliminated or substantially reduced:</p>
<ul>
<li><p>Dangling pointer bugs , which occur when a piece of memory is freed while there are<br>still pointers to it, and one of those pointers is dereferenced. By then the memory<br>may have been reassigned to another use, with unpredictable results.</p>
</li>
<li><p>Double free bugs , which occur when the program tries to free a region of memory<br>that has already been freed, and perhaps already been allocated again.</p>
</li>
<li><p>Certain kinds of memory leaks , in which a program fails to free memory occupied by<br>objects that have become unreachable , which can lead to memory exhaustion.<br>(Garbage collection typically does not deal with the unbounded accumulation of data<br>that is reachable, but that will actually not be used by the program.)</p>
</li>
<li><p>Efficient implementations of persistent data structures<br>Some of the bugs addressed by garbage collection can have security implications.</p>
</li>
</ul>
<h4 id="Disadvantages">Disadvantages</h4><p>Typically, garbage collection has certain disadvantages:</p>
<ul>
<li><p>Garbage collection consumes computing resources in deciding which memory to<br>free, even though the programmer may have already known this information. The<br>penalty for the convenience of not annotating object lifetime manually in the source<br>code is overhead , which can lead to decreased or uneven performance. Interaction<br>with memory hierarchy effects can make this overhead intolerable in circumstances<br>that are hard to predict or to detect in routine testing.</p>
</li>
<li><p>The moment when the garbage is actually collected can be unpredictable, resulting<br>in stalls scattered throughout a session. Unpredictable stalls can be unacceptable in<br>realtime environments , in transaction processing , or in interactive programs.<br>Incremental, concurrent, and realtime garbage collectors address these problems, with varying tradeoffs.</p>
</li>
<li><p>Nondeterministic GC is incompatible with RAII based management of nonGCed<br>resources. As a result, the need for explicit manual resource management<br>(release/close) for nonGCed resources becomes transitive to composition. That is:<br>in a nondeterministic GC system, if a resource or a resourcelike<br>object requires manual resource management (release/close), and this object is used as ‘part of’<br>another object, then the composed object will also become a resourcelike<br>object that itself requires manual resource management (release/close).</p>
</li>
</ul>
<h4 id="IDisposable">IDisposable</h4><table>
<thead>
<tr>
<th></th>
<th>IEnumerable</th>
<th>IQueryable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Namespace</td>
<td>System.Collections Namespace</td>
<td>System.Linq Namespace</td>
</tr>
<tr>
<td>Derives from</td>
<td>No base interface</td>
<td>Derives from IEnumerable</td>
</tr>
<tr>
<td>Deferred Execution</td>
<td>Supported</td>
<td>Supported</td>
</tr>
<tr>
<td>Lazy Loading</td>
<td>Not Supported</td>
<td>Supported</td>
</tr>
<tr>
<td>How does it work</td>
<td>While querying data from database, IEnumerable execute select query on server side, load data in-memory on client side and then filter data. Hence does more work and becomes slow.</td>
<td>While querying data from database, IQueryable execute select query on server side with all filters. Hence does less work and becomes fast.</td>
</tr>
<tr>
<td>Suitable for</td>
<td>LINQ to Object and LINQ to XML queries.</td>
<td>LINQ to SQL queries.</td>
</tr>
<tr>
<td>Custom Query</td>
<td>Doesn’t supports.</td>
<td>Supports using CreateQuery and Execute methods.</td>
</tr>
<tr>
<td>Extension method parameter</td>
<td>Extension methods supported in IEnumerable takes functional objects.</td>
<td>Extension methods supported in IEnumerable takes expression objects i.e. expression tree.</td>
</tr>
<tr>
<td>When to use</td>
<td>when querying data from in-memory collections like List, Array etc.</td>
<td>when querying data from out-memory (like remote database, service) collections.</td>
</tr>
<tr>
<td>Best Uses</td>
<td>In-memory traversal</td>
<td>Paging</td>
</tr>
</tbody>
</table>
<h3 id="C#/Javascript_prime_number">C#/Javascript prime number</h3><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PrintPrime</span>(<span class="params"><span class="keyword">int</span> <span class="keyword">value</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span>[] primes = <span class="keyword">new</span> <span class="keyword">bool</span>[<span class="keyword">value</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="keyword">value</span>; i++) &#123;</span><br><span class="line">        primes[i] = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> limit = Math.Sqrt(<span class="keyword">value</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; limit; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (primes[i] == <span class="keyword">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i * i; j &lt; <span class="keyword">value</span>; j += i)</span><br><span class="line">            &#123;</span><br><span class="line">                primes[j] = <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="keyword">value</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (primes[i] == <span class="keyword">true</span>) &#123;</span><br><span class="line">            Console.WriteLine(<span class="keyword">string</span>.Format(<span class="string">"&#123;0&#125; is Prime number"</span>, i));</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="comment">// Write prime numbers between 0 and 100.</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        Console.WriteLine(<span class="string">"--- Primes between 0 and 100 ---"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">bool</span> prime = PrimeTool.IsPrime(i);</span><br><span class="line">            <span class="keyword">if</span> (prime)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.Write(<span class="string">"Prime: "</span>);</span><br><span class="line">                Console.WriteLine(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">PrimeTool</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">IsPrime</span>(<span class="params"><span class="keyword">int</span> candidate</span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="comment">// Test whether the parameter is a prime number.</span></span><br><span class="line">        <span class="keyword">if</span> ((candidate &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (candidate == <span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Note:</span></span><br><span class="line">        <span class="comment">// ... This version was changed to test the square.</span></span><br><span class="line">        <span class="comment">// ... Original version tested against the square root.</span></span><br><span class="line">        <span class="comment">// ... Also we exclude 1 at the end.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; (i * i) &lt;= candidate; i += <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((candidate % i) == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> candidate != <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPrime</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; value; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(value % i === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value &gt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printPrime</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> primes = [];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; value; i++) &#123;</span><br><span class="line">        primes[i] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> limit = <span class="built_in">Math</span>.sqrt(value);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; limit; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(primes[i] === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> j = i * i; j &lt; value; j += i) &#123;</span><br><span class="line">                primes[j] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; value; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(primes[i] === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i + <span class="string">" "</span> + primes[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Stack_to_Queue">Stack to Queue</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Queue</span>&lt;<span class="title">E</span>&gt;</span><br><span class="line"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Stack&lt;E&gt; inbox = <span class="keyword">new</span> Stack&lt;E&gt;();</span><br><span class="line">    <span class="keyword">private</span> Stack&lt;E&gt; outbox = <span class="keyword">new</span> Stack&lt;E&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">queue</span><span class="params">(E item)</span> </span>&#123;</span><br><span class="line">        inbox.push(item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">dequeue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (outbox.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!inbox.isEmpty()) &#123;</span><br><span class="line">               outbox.push(inbox.pop());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> outbox.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="SOA">SOA</h3><p>A service-oriented architecture (SOA) is an architectural pattern in computer software design in which application components provide services to other components via a communications protocol, typically over a network. The principles of service-orientation are independent of any vendor, product or technology.[1]</p>
<p>A service is a self-contained unit of functionality, such as retrieving an online bank statement. By that definition, a service is a discretely invokable operation. However, in the Web Services Definition Language (WSDL), a service is an interface definition that may list several discrete services/operations. And elsewhere, the term service is used for a component that is encapsulated behind an interface. This widespread ambiguity is reflected in what follows.</p>
<p>Services can be combined to provide the functionality of a large software application. SOA makes it easier for software components on computers connected over a network to cooperate. Every computer can run any number of services, and each service is built in a way that ensures that the service can exchange information with any other service in the network without human interaction and without the need to make changes to the underlying program itself.</p>
<h3 id="OO_Plinciple">OO Plinciple</h3><h4 id="Encapsulation">Encapsulation</h4><p>In a nutshell, encapsulation is the hiding of data implementation by restricting access to accessors and mutators。</p>
<h4 id="Abstraction">Abstraction</h4><p>The best definition of abstraction I’ve ever read is: “An abstraction denotes the essential characteristics of an object that distinguish it from all other kinds of object and thus provide crisply defined conceptual boundaries, relative to the perspective of the viewer.” — G. Booch, Object-Oriented Design With Applications, Benjamin/Cummings, Menlo Park, California, 1991.</p>
<p>Data abstraction is nothing more than the implementation of an object that contains the same essential properties and actions we can find in the original object we are representing.</p>
<h4 id="Inheritance">Inheritance</h4><p>“Is a” is the inheritance way of object relationship.</p>
<p>Rather than duplicate functionality, inheritance allows you to inherit functionality from another class, called a superclass or base class.</p>
<h4 id="Polymorphism">Polymorphism</h4><p>Polymorphism manifests itself by having multiple methods all with the same name, but slighty different functionality.</p>
<p>There are 2 basic types of polymorphism.<br>Overridding, also called run-time polymorphism, and overloading, which is referred to as compile-time polymorphism.  This difference is, for method overloading, the compiler determines which method will be executed, and this decision is made when the code gets compiled.<br>Which method will be used for method overriding is determined at runtime based on the dynamic type of an object.</p>
<h3 id="Reflection">Reflection</h3><p>In computer science, reflection is the ability of a computer program to examine (see type introspection) and modify its own structure and behavior (specifically the values, meta-data, properties and functions) at runtime.</p>
<h4 id="Uses">Uses</h4><p>Reflection can be used for observing and modifying program execution at runtime. A reflection-oriented program component can monitor the execution of an enclosure of code and can modify itself according to a desired goal related to that enclosure. This is typically accomplished by dynamically assigning program code at runtime.</p>
<p>In object oriented programming languages such as Java, reflection allows inspection of classes, interfaces, fields and methods at runtime without knowing the names of the interfaces, fields, methods at compile time. It also allows instantiation of new objects and invocation of methods.</p>
<p>Reflection can also be used to adapt a given program to different situations dynamically. For example, consider an application that uses two different classes X and Y interchangeably to perform similar operations. Without reflection-oriented programming, the application might be hard-coded to call method names of class X and class Y. However, using the reflection-oriented programming paradigm, the application could be designed and written to utilize reflection in order to invoke methods in classes X and Y without hard-coding method names. Reflection-oriented programming almost always requires additional knowledge, framework, relational mapping, and object relevance in order to take advantage of more generic code execution.</p>
<p>Reflection is often used as part of software testing, such as for the runtime creation/instantiation of mock objects.</p>
<p>Reflection is also a key strategy for metaprogramming.</p>
<p>In some object-oriented programming languages, such as C# and Java, reflection can be used to override member accessibility rules. For example, reflection makes it possible to change the value of a field marked “private” in a third-party library’s class.</p>
<h4 id="Implementation">Implementation</h4><ol>
<li><p>The runtime creation/instantiation of mock objects.</p>
</li>
<li><p>Metaprogramming</p>
</li>
<li><p>Reflection can be used to override member accessibility rules.(C#/Java).</p>
</li>
<li><p>Discover and modify source code constructions (such as code blocks, classes, methods, protocols, etc.) as a first-class object at runtime.</p>
</li>
<li><p>Convert a string matching the symbolick name of a class or function into reference to or invocations of that class or function.</p>
</li>
<li><p>Evaluate a string as if it were a source code statement at runtime.</p>
</li>
<li><p>Create a new interpreter for the language’s bytecode to give a new meaning or purpose for a programming construct.</p>
</li>
</ol>
<h3 id="Partial_Class(C#_2-0)">Partial Class(C# 2.0)</h3><p>Partial classes are portions of a class that the compiler can combine to form a complete class. </p>
<p><strong>Partial classes allow the splitting of a class definition across multiple files</strong></p>
<h4 id="Benifits:">Benifits:</h4><ul>
<li><p>Useful for tools that are generating or modifying code.<br>With partial classes, the tools can work on a file separate from the one the developer is manually coding.</p>
</li>
<li><p>Place any nested classes into their own files.  This is in accordance with the coding convention that places each class definition within its own file. </p>
</li>
</ul>
<h4 id="Limition:">Limition:</h4><p>Partial classes do not allow <strong>extending compiled classes</strong>, or <strong>classes in other assemblies</strong>. </p>
<p>They are only a means of splitting a class implementation across multiple files within the <strong>same assembly</strong>.</p>
<h3 id="Partial_Methods(C#_3-0)">Partial Methods(C# 3.0)</h3><p>Partial methods allow for a declaration of a method without requiring an implementation. </p>
<p>However, when the optional implementation is included, it can be located in one of the sister partial class definitions, likely in a separate file.</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// File: Person.Designer.cs</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="preprocessor">#<span class="keyword">region</span> Extensibility Method Definitions</span></span><br><span class="line">    <span class="function"><span class="keyword">partial</span> <span class="keyword">void</span> <span class="title">OnLastNameChanging</span>(<span class="params"><span class="keyword">string</span> <span class="keyword">value</span></span>)</span>;</span><br><span class="line">    <span class="function"><span class="keyword">partial</span> <span class="keyword">void</span> <span class="title">OnFirstNameChanging</span>(<span class="params"><span class="keyword">string</span> <span class="keyword">value</span></span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="preprocessor">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">public</span> System.Guid PersonId</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> System.Guid _PersonId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> LastName</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _LastName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((_LastName != <span class="keyword">value</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                OnLastNameChanging(<span class="keyword">value</span>);</span><br><span class="line"></span><br><span class="line">                _LastName = <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _LastName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> FirstName</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _FirstName;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((_FirstName != <span class="keyword">value</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                OnFirstNameChanging(<span class="keyword">value</span>);</span><br><span class="line"></span><br><span class="line">                _FirstName = <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _FirstName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// File: Person.cs</span></span><br><span class="line"><span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">partial</span> <span class="keyword">void</span> <span class="title">OnLastNameChanging</span>(<span class="params"><span class="keyword">string</span> <span class="keyword">value</span></span>)</span><br><span class="line">  </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">value</span> == <span class="keyword">null</span>)</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="string">"LastName"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="keyword">value</span>.Trim().Length == <span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(</span><br><span class="line">              <span class="string">"LastName cannot be empty."</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Benfits">Benfits</h4><p>1.<strong>Accommodate code generation</strong></p>
<ol>
<li>Partial methods allow generated code to call methods that have not necessarily been implemented. </li>
</ol>
<p>Even though the declarations of partial methods contain no implementation, this code will successfully compile.</p>
<ol>
<li>If there is no implementation provided for a partial method, no trace of the partial method appears in the CIL. This helps keep code size small while keeping flexibility high.</li>
</ol>
<h4 id="Limitation">Limitation</h4><ol>
<li><p><strong>Partial methods are allowed only within partial classes</strong></p>
</li>
<li><p><strong>Partial methods must return void</strong></p>
</li>
<li><p>Similarly, <code>out</code> parameters are not allowed on partial methods. </p>
</li>
<li><p>If a return value is required, <code>ref</code> parameters may be used.</p>
</li>
</ol>
<h3 id="Design_pattern">Design pattern</h3><h4 id="Singleton_Pattern">Singleton Pattern</h4><blockquote>
<p>In software engineering, the singleton pattern is a design pattern that restricts the instantiation of a class to one object. </p>
</blockquote>
<h5 id="Benifits:-1">Benifits:</h5><blockquote>
<p>This is useful when exactly one object is needed to coordinate actions across the system. </p>
<p>The concept is sometimes generalized to systems that operate more efficiently when only one object exists, or that restrict the instantiation to a certain number of objects.</p>
</blockquote>
<h5 id="Implementation-1">Implementation</h5><blockquote>
<p>Implementation of a singleton pattern must satisfy the single instance and global access principles.</p>
<p>It requires a mechanism to access the singleton class member without creating a class object and a mechanism to persist the value of class members among class objects.</p>
<p>The singleton pattern is implemented by creating a class with a method that creates a new instance of the class if one does not exist. </p>
<p>If an instance already exists, it simply returns a reference to that object. </p>
<p>To make sure that the object cannot be instantiated any other way, the constructor is made private. </p>
<p>Note the distinction between a simple static instance of a class and a singleton: although a singleton can be implemented as a static instance, it can also be lazily constructed, requiring no memory or resources until needed.</p>
<p>The singleton pattern must be carefully constructed in multi-threaded applications. </p>
<p>If two threads are to execute the creation method at the same time when a singleton does not yet exist, they both must check for an instance of the singleton and then only one should create the new one.</p>
<p>If the programming language has concurrent processing capabilities the method should be constructed to execute as a mutually exclusive operation. </p>
<p>The classic solution to this problem is to use mutual exclusion on the class that indicates that the object is being instantiated.</p>
</blockquote>
<h3 id="Agile">Agile</h3><h4 id="Agile_for_Customers">Agile for Customers</h4><h3 id="Process_Thread">Process Thread</h3><p><a href="https://en.wikipedia.org/wiki/Process_(computing" target="_blank" rel="external">Process</a>)<br><a href="https://en.wikipedia.org/wiki/Thread_(computing" target="_blank" rel="external">Thread</a>)</p>
<h3 id="What_is_the_default_access_modifier_for_classes,_methods,_members,_constructors,_delegates_and_interfaces?">What is the default access modifier for classes, methods, members, constructors, delegates and interfaces?</h3><p>The default access for everything in C# is “the most restricted access you could declare for that member”.</p>
<p>So for example:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyCompany</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Outer</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">        <span class="keyword">class</span> <span class="title">Inner</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>is equivalent to</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyCompany</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Outer</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">class</span> <span class="title">Inner</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The one sort of exception to this is making one part of a property (usually the setter) more restricted than the declared accessibility of the property itself:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">string</span> Name</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; ... &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">set</span> &#123; ... &#125; <span class="comment">// This isn't the default, have to do it explicitly</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This is what the C# 3.0 specification has to say (section 3.5.1):</p>
<blockquote>
<p>Depending on the context in which a member declaration takes place, only certain types of declared accessibility are permitted. Furthermore, when a member declaration does not include any access modifiers, the context in which the declaration takes place determines the default declared accessibility.</p>
<p>Namespaces implicitly have public declared accessibility. No access modifiers are allowed on namespace declarations.</p>
<p>Types declared in compilation units or namespaces can have public or internal declared accessibility and default to internal declared accessibility.</p>
<p>Class members can have any of the five kinds of declared accessibility and default to private declared accessibility. (Note that a type declared as a member of a class can have any of the five kinds of declared accessibility, whereas a type declared as a member of a namespace can have only public or internal declared accessibility.)</p>
<p>Struct members can have public, internal, or private declared accessibility and default to private declared accessibility because structs are implicitly sealed. Struct members introduced in a struct (that is, not inherited by that struct) cannot have protected or protected internal declared accessibility. (Note that a type declared as a member of a struct can have public, internal, or private declared accessibility, whereas a type declared as a member of a namespace can have only public or internal declared accessibility.)</p>
<p>Interface members implicitly have public declared accessibility. No access modifiers are allowed on interface member declarations.</p>
<p>Enumeration members implicitly have public declared accessibility. No access modifiers are allowed on enumeration member declarations.</p>
</blockquote>
<p>(Note that nested types would come under the “class members” or “struct members” parts - and therefore default to private visibility.)</p>
<h3 id="Access_Modifiers">Access Modifiers</h3><p><strong>public</strong></p>
<p>The type or member can be accessed by any other code in the same assembly or another assembly that references it.</p>
<p><strong>private</strong></p>
<p>The type or member can be accessed only by code in the same class or struct.</p>
<p><strong>protected</strong></p>
<p>The type or member can be accessed only by code in the same class or struct, or in a class that is derived from that class.</p>
<p><strong>internal</strong></p>
<p>The type or member can be accessed by any code in the same assembly, but not from another assembly.</p>
<p><strong>protected internal</strong></p>
<p>The type or member can be accessed by any code in the assembly in which it is declared, or from within a derived class in another assembly. Access from another assembly must take place within a class declaration that derives from the class in which the protected internal element is declared, and it must take place through an instance of the derived class type.</p>
<h3 id="Structs">Structs</h3><p>Structs share most of the same syntax as classes, although structs are more limited than classes:</p>
<ul>
<li>Within a struct declaration, fields cannot be initialized unless they are declared as const or static.</li>
<li>A struct cannot declare a default constructor (a constructor without parameters) or a destructor.</li>
<li>Structs are copied on assignment. When a struct is assigned to a new variable, all the data is copied, and any modification to the new copy does not change the data for the original copy. This is important to remember when working with collections of value types such as Dictionary<string, mystruct="">.</string,></li>
<li>Structs are value types and classes are reference types.</li>
<li>Unlike classes, structs can be instantiated without using a new operator.</li>
<li>Structs can declare constructors that have parameters.</li>
<li>A struct cannot inherit from another struct or class, and it cannot be the base of a class. All structs inherit directly from System.ValueType, which inherits from System.Object.</li>
<li>A struct can implement interfaces.</li>
<li>A struct can be used as a nullable type and can be assigned a null value.</li>
</ul>
<h3 id="LINQ">LINQ</h3><p>Rather than add relational or XML-specific features to our programming languages and runtime, with the LINQ project we have taken</p>
<p><strong> a more general approach and are adding general-purpose query facilities to the .NET Framework that apply to all sources of information, not just relational or XML data. </strong></p>
<p>This facility is called .NET Language-Integrated Query (LINQ).</p>
<h4 id="Benfits-1">Benfits</h4><p>We use the term language-integrated query to indicate that </p>
<ul>
<li><p>Query is an integrated feature of the developer’s primary programming languages (for example, Visual C#, Visual Basic).</p>
</li>
<li><p>Language-integrated query allows query expressions to benefit from the rich metadata,</p>
</li>
<li><p>compile-time syntax checking,</p>
</li>
<li><p>static typing </p>
</li>
<li><p>IntelliSense that was previously available only to imperative code. </p>
</li>
<li><p>Language-integrated query also allows a single general purpose declarative query facility to be applied to all in-memory information, not just information from external sources.</p>
</li>
</ul>
<h4 id="Implementation-2">Implementation</h4><p>.NET Language-Integrated Query defines a set of general purpose standard query operators that allow traversal, filter, and projection operations to be expressed in a direct yet declarative way in any .NET-based programming language.</p>
<p>The standard query operators allow queries to be applied to any IEnumerable<t>-based information source.</t></p>
<p>LINQ allows third parties to augment the set of standard query operators with new domain-specific operators that are appropriate for the target domain or technology.</p>
<p>More importantly, third parties are also free to replace the standard query operators with their own implementations that provide additional services such as remote evaluation, query translation, optimization, and so on. </p>
<p>By adhering to the conventions of the LINQ pattern, such implementations enjoy the same language integration and tool support as the standard query operators.</p>
<p>The extensibility of the query architecture is used in the LINQ project itself to provide implementations that work over both XML and SQL data. </p>
<p>The query operators over XML (LINQ to XML) use an efficient, easy-to-use, in-memory XML facility to provide XPath/XQuery functionality in the host programming language.</p>
<p>The query operators over relational data (LINQ to SQL) build on the integration of SQL-based schema definitions into the common language runtime (CLR) type system. </p>
<p>This integration provides strong typing over relational data while retaining the expressive power of the relational model and the performance of query evaluation directly in the underlying store.</p>
<p>Interview<br>algorithm/design<br>1.factory, abstract factory and factory method<br>2.implement a singleton class<br>3.bubble sort, quick sort and binary insertion sort<br>4.reverse a string (with different ways). What’s the design pattern you will use to support different implementation?<br>5.print Fibonacci series in different ways<br>6.SOLID principles</p>
<p>.net</p>
<ol>
<li>What’s the difference between abstract class and interface<br>2.what is delegate<br>3.how many ways for multi-thread synchronisation</li>
</ol>
<blockquote>
<p>For simple operations on integral numeric data types, synchronizing threads can be accomplished with members of the Interlocked class. For all other data types and non thread-safe resources, multithreading can only be safely performed using the constructs in this topic</p>
</blockquote>
<p>*Lock</p>
<p>The <strong>lock</strong> (C#) statements can be used to ensure that a block of code runs to completion without interruption by other threads. This is accomplished by obtaining a mutual-exclusion lock for a given object for the duration of the code block.C</p>
<p>A <strong>lock</strong> statement is given an object as an argument, and is followed by a code block that is to be executed by only one thread at a time. For example:</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestThreading</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> System.Object lockThis = <span class="keyword">new</span> System.Object();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Process</span>(<span class="params"></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">lock</span> (lockThis)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Access thread-sensitive resources.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>*Interlocked</p>
<p>4.how GC works<br>5.describe mvc/web api pipeline</p>
<ol>
<li>How asyn/await works and what’s the benefit of using that?<br>7.whats the difference between static string</li>
</ol>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">&raquo;</a>
  </nav>

 </div>

        

        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="css/images/1035498.gif" alt="Chandler" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Chandler</p>
        </div>
        <p class="site-description motion-element" itemprop="description">Chandler's Blog</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">25</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">categories</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">tags</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chandler</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    
    

  


  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
